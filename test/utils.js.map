{
  "version": 3,
  "file": "",
  "sourceRoot": "",
  "sources": [
    "test/utils.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "# utils.coffee\n\nimport {\n\tundef, defined, notdefined, getOptions, CWS,\n\tshuffle, keys, hasKey,\n\t} from '@jdeighan/base-utils'\nimport {assert, croak} from '@jdeighan/base-utils/exceptions'\nimport {LOG} from '@jdeighan/base-utils/log'\nimport {dbgEnter, dbgReturn, dbg} from '@jdeighan/base-utils/debug'\nimport {\n\tmkpath, isFile,\n\t} from '@jdeighan/base-utils/fs'\nimport {FileProcessor} from '@jdeighan/base-utils/FileProcessor'\n\n# ---------------------------------------------------------------------------\n\nexport splitEn = (enStr) =>\n\n\tdbgEnter 'splitEn', enStr\n\tlWords = []\n\tfor str in enStr.split(',')\n\t\tlWords.push CWS(str)\n\tdbgReturn 'splitEn', lWords\n\treturn lWords\n\n# ---------------------------------------------------------------------------\n# e.g. splits \"打扰 dǎ rǎo, 麻烦 má fan\"\n# into [\n#    {zh: '打扰', pinyin: 'dǎ rǎo'}\n#    {zh: '麻烦', pinyin: 'má fan'}\n#    ]\n\nexport splitZh = (zhStr) =>\n\n\tlWords = []\n\tfor str in zhStr.split(',')\n\t\tif lParts = str.match(///^\n\t\t\t\t\\s*\n\t\t\t\t([A-Z\\u4E00-\\u9FFF]+)  # Chinese characters\n\t\t\t\t(?:\n\t\t\t\t\t\\s*\n\t\t\t\t\t[\\!\\?]\n\t\t\t\t\t)?\n\t\t\t\t\\s+\n\t\t\t\t([A-Za-z\\s'āáǎàēéěèīíǐìōóǒòūúǔùǖüǘǚǜ]+)\n\t\t\t\t(?:\n\t\t\t\t\t\\s*\n\t\t\t\t\t[\\!\\?]\n\t\t\t\t\t)?\n\t\t\t\t\\s*\n\t\t\t\t$///)\n\t\t\t[_, zh, pinyin] = lParts\n\t\t\tlWords.push {\n\t\t\t\tzh: CWS(zh)\n\t\t\t\tpinyin: CWS(pinyin)\n\t\t\t\t}\n\t\telse\n\t\t\tcroak \"splitZh('#{zhStr}') - bad zh string\"\n\treturn lWords\n\n# ---------------------------------------------------------------------------\n# --- Should handle lines in:\n#        test.zh\n#        keepers.zh\n#        nouns.zh, etc.\n\nexport line2hWord = (line) ->\n\n\tdbgEnter 'line2hWord', line\n\tif notdefined(line) || (line.length == 0)\n\t\tdbgReturn 'line2hWord', undef\n\t\treturn undef\n\telse if lMatches = line.match(///^\n\t\t\t\\s*\n\t\t\t(?:\n\t\t\t\t([0-9]+) # one or more digits\n\t\t\t\t\\s*\n\t\t\t\t)?\n\t\t\t(?:\n\t\t\t\t(\\*+)    # some number of * chars\n\t\t\t\t\\s*\n\t\t\t\t)?\n\t\t\t(?:         # optional empty checkbox\n\t\t\t\t□\n\t\t\t\t\\s*\n\t\t\t\t)?\n\t\t\t\\s*         # skip white space\n\t\t\t(.*)        # the rest\n\t\t\t$///)\n\t\t[_, numStr, astStr, rest] = lMatches\n\t\tdbg \"rest = '#{rest}'\"\n\n\t\t# --- get number of correct tests\n\t\tnum = 0\n\t\tif defined(numStr)\n\t\t\tnum = parseInt(numStr, 10)\n\t\tif defined(astStr)\n\t\t\tnum += astStr.length\n\n\t\tpos = rest.indexOf('-')\n\t\tdbg \"pos = #{pos}\"\n\n\t\tzhStr = rest.substring(0, pos)\n\t\tenStr = rest.substring(pos+1)\n\t\tdbg \"zhStr = '#{zhStr}'\"\n\t\tdbg \"enStr = '#{enStr}'\"\n\n\t\thWord = {\n\t\t\tnum\n\t\t\tzh:     splitZh(zhStr)\n\t\t\ten:     splitEn(enStr)\n\t\t\t}\n\t\taddKey hWord\n\t\tdbgReturn 'line2hWord', hWord\n\t\treturn hWord\n\telse\n\t\tcroak \"Bad line: '#{line}'\"\n\n# ---------------------------------------------------------------------------\n\nexport zh_pinyin = (h) ->\n\n\treturn \"#{h.zh} #{h.pinyin}\"\n\n# ---------------------------------------------------------------------------\n\nexport zhStr = (hWord) ->\n\n\tlParts = for h in hWord.zh\n\t\tzh_pinyin(h)\n\treturn lParts.join(', ')\n\n# ---------------------------------------------------------------------------\n\nexport enStr = (hWord) ->\n\n\treturn hWord.en.join(', ')\n\n# ---------------------------------------------------------------------------\n\nexport hWord2line = (hWord, hOptions={}) ->\n\n\t{box, number} = getOptions hOptions, {\n\t\tbox: false\n\t\tnumber: true\n\t\t}\n\tstr = \"\"\n\tif number\n\t\tstr += \"#{hWord.num} \"\n\tif box\n\t\tstr += \"□ \"\n\tstr += \"#{zhStr(hWord)} - #{enStr(hWord)}\\n\"\n\treturn str\n\n# ---------------------------------------------------------------------------\n\nexport addKey = (hWord) ->\n\n\tlParts = [hWord.en.join('/')]\n\tfor h in hWord.zh\n\t\tlParts.push h.zh\n\t\tlParts.push h.pinyin\n\tkey = lParts.join '/'\n\thWord.key = key\n\treturn\n\n# ---------------------------------------------------------------------------\n\nexport getWords = (hOptions={}) ->\n\t# --- path can be a file or a directory\n\t#     words are ordered by hWord.num, but\n\t#        scrambled for words w/same num\n\n\tdbgEnter 'getWords', hOptions\n\t{path, debug, limit, filter, lExclude\n\t\t\t} = getOptions hOptions, {\n\t\tpath: './words'\n\t\tdebug: false\n\t\tfilter: (h) -> return (h.ext == '.zh')\n\t\tlExclude: []\n\t\t}\n\n\t# --- { <num>: [hWord, ...] }\n\thWords = {}\n\n\taddWord = (h) =>\n\t\tnum = h.num\n\t\tif hasKey(hWords, num)\n\t\t\thWords[num].push h\n\t\telse\n\t\t\thWords[num] = [h]\n\n\tfp = new FileProcessor(path, {debug})\n\tfp.filter = filter\n\tfp.handleLine = (line, lineNum, hFileInfo) ->\n\t\thWord = line2hWord(line)\n\t\tif lExclude.includes hWord.key\n\t\t\treturn\n\t\thWord.filePath = hFileInfo.filePath\n\t\thWord.lineNum = lineNum\n\t\taddWord hWord\n\tfp.go()\n\n\tlWords = []\n\tfor num in keys(hWords)\n\t\tshuffle hWords[num]\n\t\tlWords.push ...hWords[num]\n\n\t# --- lWords is an array of all words, ordered by\n\t#     num, but scrambled within a num\n\n\tif defined(limit)\n\t\tlWords = lWords.slice(0, limit)\n\tdbgReturn 'getWords', lWords\n\treturn lWords\n\n# ---------------------------------------------------------------------------\n\nexport getTestWords = (hOptions={}) ->\n\n\tlTestWords = getWords getOptions(hOptions, {\n\t\tpath: './test.zh'\n\t\t})\n\ttotalCount = 0\n\tfor hWord in lTestWords\n\t\ttotalCount += hWord.num\n\tassert (totalCount > 5), \"Bad test file\"\n\treturn lTestWords"
  ]
}