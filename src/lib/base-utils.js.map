{
  "version": 3,
  "file": "base-utils.js",
  "sourceRoot": "..\\..\\",
  "sources": [
    "src\\lib\\base-utils.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "# base-utils.coffee\r\n\r\nimport {execSync} from 'node:child_process'\r\nimport assertLib from 'node:assert'\r\n\r\n# --- ABSOLUTELY NO IMPORTS FROM OUR LIBS !!!!!\r\n\r\n`export const undef = void 0`\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport LOG = (lItems...) =>\r\n\r\n\tlSimpleItems = []\r\n\tfor item in lItems\r\n\t\tif isHash(item) || isArray(item)\r\n\t\t\tif (lSimpleItems.length > 0)\r\n\t\t\t\tconsole.log lSimpleItems...\r\n\t\t\t\tlSimpleItems = []\r\n\t\t\tconsole.dir item, {depth: null}\r\n\t\telse\r\n\t\t\tlSimpleItems.push item\r\n\tif (lSimpleItems.length > 0)\r\n\t\tconsole.log lSimpleItems...\r\n\treturn\r\n\r\n# ---------------------------------------------------------------------------\r\n# low-level version of assert()\r\n\r\nexport assert = (cond, msg) =>\r\n\r\n\tif !cond\r\n\t\tthrow new Error(msg)\r\n\treturn true\r\n\r\n# ---------------------------------------------------------------------------\r\n# low-level version of croak()\r\n\r\nexport croak = (msg) =>\r\n\r\n\tthrow new Error(msg)\r\n\treturn true\r\n\r\n# ---------------------------------------------------------------------------\r\n#   pass - do nothing\r\n\r\nexport pass = () =>\r\n\r\n\treturn true\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport defined = (obj) =>\r\n\r\n\treturn (obj != undef) && (obj != null)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport notdefined = (obj) =>\r\n\r\n\treturn (obj == undef) || (obj == null)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport alldefined = (lObj...) =>\r\n\r\n\tfor obj in lObj\r\n\t\tif (obj == undef) || (obj == null)\r\n\t\t\treturn false\r\n\treturn true\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport chomp = (str) =>\r\n\t# --- Remove trailing \\n if present\r\n\r\n\tlen = str.length\r\n\tif (str[len-1] == '\\n')\r\n\t\tif (str[len-2] == '\\r')\r\n\t\t\treturn str.substring(0, len-2)\r\n\t\telse\r\n\t\t\treturn str.substring(0, len-1)\r\n\telse\r\n\t\treturn str\r\n\r\n# ---------------------------------------------------------------------------\r\n#   isEmpty\r\n#      - string is whitespace, array has no elements, hash has no keys\r\n\r\nexport isEmpty = (x) =>\r\n\r\n\tif (x == undef) || (x == null)\r\n\t\treturn true\r\n\tif (typeof x == 'string')\r\n\t\treturn x.match(/^\\s*$/)\r\n\tif Array.isArray(x)\r\n\t\treturn (x.length == 0)\r\n\tif (typeof x == 'object')\r\n\t\treturn Object.keys(x).length == 0\r\n\telse\r\n\t\treturn false\r\n\r\n# ---------------------------------------------------------------------------\r\n#   nonEmpty\r\n#      - string has non-whitespace, array has elements, hash has keys\r\n\r\nexport nonEmpty = (x) =>\r\n\r\n\treturn ! isEmpty(x)\r\n\r\n# ---------------------------------------------------------------------------\r\n#   deepCopy - deep copy an array or object\r\n\r\nexport deepCopy = (obj) =>\r\n\r\n\tif (obj == undef)\r\n\t\treturn undef\r\n\tobjStr = JSON.stringify(obj)\r\n\ttry\r\n\t\tnewObj = JSON.parse(objStr)\r\n\tcatch err\r\n\t\tthrow new Error(\"ERROR: err.message\")\r\n\r\n\treturn newObj\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport add_s = (n) =>\r\n\r\n\tif (n == 1)\r\n\t\treturn ''\r\n\telse\r\n\t\treturn 's'\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport keys = (lHashes...) =>\r\n\r\n\tlKeys = []\r\n\tfor h in lHashes\r\n\t\tfor key in Object.keys(h)\r\n\t\t\tif ! lKeys.includes(key)\r\n\t\t\t\tlKeys.push key\r\n\treturn lKeys\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport hasKey = (obj, key) =>\r\n\r\n\treturn obj.hasOwnProperty(key)\r\n\r\n# ---------------------------------------------------------------------------\r\n# --- Removes key, but returns associated value\r\n\r\nexport extractKey = (h, key) =>\r\n\r\n\tassert isHash(h), \"not a hash\"\r\n\tassert isString(key), \"key not a string\"\r\n\tval = h[key]     # might be undef\r\n\tdelete h[key]\r\n\treturn val\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport hasAllKeys = (obj, lKeys...) =>\r\n\r\n\tfor key in lKeys\r\n\t\tif ! hasKey(obj, key)\r\n\t\t\treturn false\r\n\treturn true\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport hasAnyKey = (obj, lKeys...) =>\r\n\r\n\tfor key in lKeys\r\n\t\tif hasKey(obj, key)\r\n\t\t\treturn true\r\n\treturn false\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport addNewKey = (h, key, value) ->\r\n\r\n\tassert !hasKey(h, key), \"hash has key #{key}\"\r\n\th[key] = value\r\n\treturn h\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport subkeys = (obj) =>\r\n\r\n\tlSubKeys = []\r\n\tfor key in keys(obj)\r\n\t\th = obj[key]\r\n\t\tfor subkey in keys(h)\r\n\t\t\tif !lSubKeys.includes(subkey)\r\n\t\t\t\tlSubKeys.push subkey\r\n\treturn lSubKeys\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport hslice = (h, lKeys) =>\r\n\r\n\thResult = {}\r\n\tfor key in lKeys\r\n\t\thResult[key] = h[key]\r\n\treturn hResult\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport samelist = (lItems1, lItems2) =>\r\n\r\n\tassert isArray(lItems1), \"arg 1 not an array\"\r\n\tassert isArray(lItems2), \"arg 2 not an array\"\r\n\tif (lItems1.length != lItems2.length)\r\n\t\treturn false\r\n\tfor item in lItems1\r\n\t\tif ! lItems2.includes item\r\n\t\t\treturn false\r\n\tfor item in lItems2\r\n\t\tif ! lItems1.includes item\r\n\t\t\treturn false\r\n\treturn true\r\n\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport fromJSON = (strJson) =>\r\n\t# --- string to data structure\r\n\r\n\treturn JSON.parse(strJson)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport toJSON = (hJson, hOptions={}) =>\r\n\t# --- data structure to string\r\n\r\n\t{useTabs, replacer} = getOptions hOptions, {\r\n\t\tuseTabs: true\r\n\t\treplacer: undef\r\n\t\t}\r\n\tif useTabs\r\n\t\treturn JSON.stringify(hJson, replacer, \"\\t\")\r\n\telse\r\n\t\treturn JSON.stringify(hJson, replacer, 3)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nhExecOptions = {\r\n\tencoding: 'utf8'\r\n\twindowsHide: true\r\n\t}\r\n\r\nexport execCmd = (cmd, hOptions=hExecOptions) =>\r\n\t# --- may throw an exception\r\n\r\n\tresult = execSync cmd, hOptions\r\n\r\n\tassert isString(result), \"result = #{OL(result)}\"\r\n\treturn result\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport deepEqual = (a, b) =>\r\n\r\n\ttry\r\n\t\tassertLib.deepEqual(a, b)\r\n\tcatch error\r\n\t\tif (error.name == \"AssertionError\")\r\n\t\t\treturn false\r\n\t\tthrow error\r\n\treturn true\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isHashComment = (line) =>\r\n\t# --- true if:\r\n\t#        - 1st non-ws char is a '#'\r\n\t#        - '#' is either followed by a ws char or by nothing\r\n\r\n\tlMatches = line.match(///^\r\n\t\t\t(\\s*)\r\n\t\t\t\\#\r\n\t\t\t(\\s*)\r\n\t\t\t(.*)\r\n\t\t\t$///)\r\n\tif defined(lMatches)\r\n\t\t[_, prefix, ws, text] = lMatches\r\n\t\tif (text.length == 0)\r\n\t\t\treturn {prefix, ws, text: ''}\r\n\t\telse if (ws.length > 0)\r\n\t\t\treturn {prefix, ws, text: text.trim()}\r\n\t\telse\r\n\t\t\treturn undef\r\n\telse\r\n\t\treturn undef\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport spaces = (n) =>\r\n\r\n\treturn \" \".repeat(n)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport tabs = (n) =>\r\n\r\n\treturn \"\\t\".repeat(n)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport centeredText = (text, width) =>\r\n\r\n\ttotSpaces = width - text.length\r\n\tif (totSpaces <= 0)\r\n\t\treturn text\r\n\tnumLeft = Math.floor(totSpaces / 2)\r\n\tnumRight = totSpaces - numLeft\r\n\treturn spaces(numLeft) + text + spaces(numRight)\r\n\r\n# ---------------------------------------------------------------------------\r\n#   rtrunc - strip nChars chars from right of a string\r\n\r\nexport rtrunc = (str, nChars) =>\r\n\r\n\treturn str.substring(0, str.length - nChars)\r\n\r\n# ---------------------------------------------------------------------------\r\n#   ltrunc - strip nChars chars from left of a string\r\n\r\nexport ltrunc = (str, nChars) =>\r\n\r\n\treturn str.substring(nChars)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport CWS = (str) =>\r\n\r\n\tassert isString(str), \"CWS(): parameter not a string\"\r\n\treturn str.trim().replace(/\\s+/sg, ' ')\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport splitPrefix = (line) =>\r\n\r\n\tassert isString(line), \"non-string #{OL(line)}\"\r\n\tline = rtrim(line)\r\n\tlMatches = line.match(/^(\\s*)(.*)$/)\r\n\treturn [lMatches[1], lMatches[2]]\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport hasPrefix = (line) =>\r\n\r\n\tassert isString(line), \"non-string #{OL(line)}\"\r\n\tlMatches = line.match(/^(\\s*)/)\r\n\treturn (lMatches[1].length > 0)\r\n\r\n# ---------------------------------------------------------------------------\r\n#    tabify - convert leading spaces to TAB characters\r\n#             if numSpaces is not defined, then the first line\r\n#             that contains at least one space sets it\r\n# --- Works on both blocks and arrays - returns same kind of item\r\n\r\nexport tabify = (item, numSpaces=undef) =>\r\n\r\n\tlLines = []\r\n\tfor str in toArray(item)\r\n\t\t[prefix, theRest] = splitPrefix(str)\r\n\t\tprefixLen = prefix.length\r\n\t\tif prefixLen == 0\r\n\t\t\tlLines.push theRest\r\n\t\telse\r\n\t\t\tassert (prefix.indexOf('\\t') == -1), \"found TAB\"\r\n\t\t\tif numSpaces == undef\r\n\t\t\t\tnumSpaces = prefixLen\r\n\t\t\tassert (prefixLen % numSpaces == 0), \"Bad prefix\"\r\n\t\t\tlevel = prefixLen / numSpaces\r\n\t\t\tlLines.push '\\t'.repeat(level) + theRest\r\n\tif isArray(item)\r\n\t\tresult = item\r\n\telse\r\n\t\tresult = toBlock(lLines)\r\n\treturn result\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport untabify = (str, numSpaces=3) =>\r\n\r\n\treturn str.replace(/\\t/g, ' '.repeat(numSpaces))\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport forEachLine = (item, func) =>\r\n\t# --- callback to func() gets arguments:\r\n\t#        line - each line\r\n\t#        hInfo - with keys lineNum and nextLine\r\n\t# Return value should be:\r\n\t#    true - to stop prematurely\r\n\t#    false - to continue\r\n\r\n\tlInput = toArray(item)\r\n\tfor line,i in lInput\r\n\t\tresult = func(line, {\r\n\t\t\tlineNum: i+1\r\n\t\t\tnextLine: lInput[i+1]\r\n\t\t\t})\r\n\t\tassert isBoolean(result), \"result must be a boolean, got #{OL(result)}\"\r\n\t\tif result   # return of true causes premature exit\r\n\t\t\treturn\r\n\treturn\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport mapEachLine = (item, func) =>\r\n\t# --- callback to func() gets arguments:\r\n\t#        line - each line\r\n\t#        hInfo - with keys lineNum and nextLine\r\n\t#     callback return value should be:\r\n\t#        undef - to skip this line\r\n\t#        else value to include\r\n\r\n\tlLines = []    # return value\r\n\tlInput = toArray(item)\r\n\tfor line,i in lInput\r\n\t\tresult = func(line, {\r\n\t\t\tlineNum: i+1\r\n\t\t\tnextLine: lInput[i+1]\r\n\t\t\t})\r\n\t\tif defined(result)\r\n\t\t\tlLines.push result\r\n\tif isArray(item)\r\n\t\treturn lLines\r\n\telse\r\n\t\treturn toBlock(lLines)\r\n\r\n# ---------------------------------------------------------------------------\r\n# --- a replacer is (key, value) -> newvalue\r\n\r\nmyReplacer = (name, value) =>\r\n\r\n\tif (value == undef)\r\n\t\treturn undef\r\n\telse if (value == null)\r\n\t\treturn null\r\n\telse if isString(value)\r\n\t\treturn escapeStr(value)\r\n\telse if (typeof value == 'function')\r\n\t\treturn \"[Function: #{value.name}]\"\r\n\telse\r\n\t\treturn value\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport OL = (obj) =>\r\n\r\n\tif defined(obj)\r\n\t\tif isString(obj)\r\n\t\t\treturn quoted(obj, 'escape')\r\n\t\telse\r\n\t\t\treturn JSON.stringify(obj, myReplacer)\r\n\telse if (obj == null)\r\n\t\treturn 'null'\r\n\telse\r\n\t\treturn 'undef'\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport OLS = (lObjects, sep=',') =>\r\n\r\n\tassert isArray(lObjects), \"not an array\"\r\n\tlParts = []\r\n\tfor obj in lObjects\r\n\t\tlParts.push OL(obj)\r\n\treturn lParts.join(sep)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport qStr = (x) =>\r\n\t# --- x must be string or undef\r\n\t#     puts quotes around a string\r\n\r\n\tif notdefined(x)\r\n\t\treturn 'undef'\r\n\telse if isString(x)\r\n\t\treturn \"'#{x}'\"\r\n\telse\r\n\t\tthrow new Error(\"quoteStr(): Not a string or undef\")\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport quoted = (str, escape=undef) =>\r\n\r\n\tassert isString(str), \"not a string: #{str}\"\r\n\tswitch escape\r\n\t\twhen 'escape'\r\n\t\t\tstr = escapeStr(str)\r\n\t\twhen 'escapeNoNL'\r\n\t\t\tstr = escapeStr(str, hEscNoNL)\r\n\t\telse\r\n\t\t\tpass\r\n\r\n\tif ! hasChar(str, \"'\")\r\n\t\treturn \"'\" + str + \"'\"\r\n\tif ! hasChar(str, '\"')\r\n\t\treturn '\"' + str + '\"'\r\n\treturn '<' + str + '>'\r\n\r\n# ---------------------------------------------------------------------------\r\n#   escapeStr - escape newlines, carriage return, TAB chars, etc.\r\n\r\nexport hEsc = {\r\n\t\"\\r\": '◄'\r\n\t\"\\n\": '▼'\r\n\t\"\\t\": '→'\r\n\t\" \": '˳'\r\n\t}\r\nexport hEscNoNL = {\r\n\t\"\\t\": '→'\r\n\t\" \": '˳'\r\n\t}\r\n\r\nexport escapeStr = (str, hReplace=hEsc) =>\r\n\t# --- hReplace can also be a string:\r\n\t#        'esc'     - escape space, newline, tab\r\n\t#        'escNoNL' - escape space, tab\r\n\r\n\tif isString(hReplace)\r\n\t\tswitch hReplace\r\n\t\t\twhen 'esc'\r\n\t\t\t\thReplace = hEsc\r\n\t\t\twhen 'escNoNL'\r\n\t\t\t\thReplace = hExcNoNL\r\n\t\t\telse\r\n\t\t\t\tthrow new Error(\"Invalid hReplace string value\")\r\n\r\n\tassert isString(str), \"escapeStr(): not a string\"\r\n\tlParts = for ch in str.split('')\r\n\t\tif defined(hReplace[ch]) then hReplace[ch] else ch\r\n\treturn lParts.join('')\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport hasChar = (str, ch) =>\r\n\r\n\treturn (str.indexOf(ch) >= 0)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport oneof = (word, lWords...) =>\r\n\r\n\treturn (lWords.indexOf(word) >= 0)\r\n\r\n# ---------------------------------------------------------------------------\r\n# see: https://stackoverflow.com/questions/40922531/how-to-check-if-a-javascript-function-is-a-constructor\r\n\r\nmyHandler = {\r\n\tconstruct: () ->\r\n\t\treturn myHandler\r\n\t} # Must return ANY object, so reuse one\r\n\r\nexport isConstructor = (x) =>\r\n\tif (typeof x != 'function')\r\n\t\treturn false\r\n\ttry\r\n\t\treturn !!(new (new Proxy(x, myHandler))())\r\n\tcatch e\r\n\t\treturn false\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport jsType = (x) =>\r\n\t# --- return [type, subtype]\r\n\r\n\tif (x == null)\r\n\t\treturn [undef, 'null']\r\n\telse if (x == undef)\r\n\t\treturn [undef, undef]\r\n\r\n\tswitch (typeof x)\r\n\t\twhen 'number'\r\n\t\t\tif Number.isNaN(x)\r\n\t\t\t\treturn ['number', 'NaN']\r\n\t\t\telse if Number.isInteger(x)\r\n\t\t\t\treturn ['number', 'integer']\r\n\t\t\telse\r\n\t\t\t\treturn ['number', undef]\r\n\t\twhen 'string'\r\n\t\t\tif x.match(/^\\s*$/)\r\n\t\t\t\treturn ['string', 'empty']\r\n\t\t\telse\r\n\t\t\t\treturn ['string', undef]\r\n\t\twhen 'boolean'\r\n\t\t\treturn ['boolean', undef]\r\n\t\twhen 'bigint'\r\n\t\t\treturn ['number', 'integer']\r\n\t\twhen 'function'\r\n\t\t\tif x.prototype && (x.prototype.constructor == x)\r\n\t\t\t\treturn ['class', undef]\r\n\t\t\telse\r\n\t\t\t\treturn ['function', x.name || undef]\r\n\t\twhen 'object'\r\n\t\t\tif (x instanceof String)\r\n\t\t\t\tif x.match(/^\\s*$/)\r\n\t\t\t\t\treturn ['string', 'empty']\r\n\t\t\t\telse\r\n\t\t\t\t\treturn ['string', undef]\r\n\t\t\tif (x instanceof Number)\r\n\t\t\t\tif Number.isInteger(x)\r\n\t\t\t\t\treturn ['number', 'integer']\r\n\t\t\t\telse\r\n\t\t\t\t\treturn ['number', undef]\r\n\t\t\tif (x instanceof Boolean)\r\n\t\t\t\treturn ['boolean', undef]\r\n\t\t\tif Array.isArray(x)\r\n\t\t\t\tif (x.length == 0)\r\n\t\t\t\t\treturn ['array', 'empty']\r\n\t\t\t\telse\r\n\t\t\t\t\treturn ['array', undef]\r\n\t\t\tif (x instanceof RegExp)\r\n\t\t\t\treturn ['regexp', undef]\r\n\t\t\tif (x instanceof Function)\r\n\t\t\t\tif x.prototype && (x.prototype.constructor == x)\r\n\t\t\t\t\treturn ['class', undef]\r\n\t\t\t\telse\r\n\t\t\t\t\treturn ['function', x.name || undef]\r\n\t\t\tif defined(x.constructor.name) \\\r\n\t\t\t\t\t&& (typeof x.constructor.name == 'string') \\\r\n\t\t\t\t\t&& (x.constructor.name == 'Object')\r\n\t\t\t\tlKeys = keys(x)\r\n\t\t\t\tif (lKeys.length == 0)\r\n\t\t\t\t\treturn ['hash', 'empty']\r\n\t\t\t\telse\r\n\t\t\t\t\treturn ['hash', undef]\r\n\t\t\telse\r\n\t\t\t\treturn ['object', undef]\r\n\t\telse\r\n\t\t\tthrow new Error (\"Unknown jsType: #{x}\")\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isString = (x) =>\r\n\r\n\treturn (jsType(x)[0] == 'string')\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isNonEmptyString = (x) =>\r\n\r\n\treturn isString(x) && ! x.match(/^\\s*$/)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isNonEmptyArray = (x) =>\r\n\r\n\treturn isArray(x) && (x.length > 0)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isNonEmptyHash = (x) =>\r\n\r\n\treturn isHash(x) && (keys(x).length > 0)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isIdentifier = (x) =>\r\n\r\n\tif ! isString(x)\r\n\t\treturn false\r\n\treturn x.match(///^\r\n\t\t\t[A-Za-z_]\r\n\t\t\t[A-Za-z0-9_]*\r\n\t\t\t$///)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isFunctionName = (x) =>\r\n\r\n\tif isString(x) && lMatches = x.match(///^\r\n\t\t\t( [A-Za-z_] [A-Za-z0-9_]* )\r\n\t\t\t(?:\r\n\t\t\t\t\\.             # allow class method names\r\n\t\t\t\t( [A-Za-z_] [A-Za-z0-9_]* )\r\n\t\t\t\t)?\r\n\t\t\t$///)\r\n\t\t[_, first, second] = lMatches\r\n\t\tif nonEmpty(second)\r\n\t\t\treturn [first, second]\r\n\t\telse\r\n\t\t\treturn [first]\r\n\telse\r\n\t\treturn undef\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isNumber = (x, hOptions=undef) =>\r\n\r\n\tif (jsType(x)[0] != 'number')\r\n\t\treturn false\r\n\tif defined(hOptions)\r\n\t\tassert isHash(hOptions), \"2nd arg not a hash: #{OL(hOptions)}\"\r\n\t\t{min, max} = hOptions\r\n\t\tif defined(min) && (x < min)\r\n\t\t\treturn false\r\n\t\tif defined(max) && (x > max)\r\n\t\t\treturn false\r\n\treturn true\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isInteger = (x, hOptions={}) =>\r\n\r\n\tif (typeof x == 'number')\r\n\t\tresult = Number.isInteger(x)\r\n\telse if (x instanceof Number)\r\n\t\tresult = Number.isInteger(x.valueOf())\r\n\telse\r\n\t\treturn false\r\n\r\n\tif result\r\n\t\tif defined(hOptions.min) && (x < hOptions.min)\r\n\t\t\tresult = false\r\n\t\tif defined(hOptions.max) && (x > hOptions.max)\r\n\t\t\tresult = false\r\n\treturn result\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isArray = (x) =>\r\n\r\n\treturn (jsType(x)[0] == 'array')\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isArrayOfArrays = (lItems, size=undef) =>\r\n\t# --- undefined items are allowed\r\n\r\n\tif ! isArray(lItems)\r\n\t\treturn false\r\n\tfor item in lItems\r\n\t\tif defined(item)\r\n\t\t\tif ! isArray(item)\r\n\t\t\t\treturn false\r\n\t\t\tif defined(size) && (item.length != size)\r\n\t\t\t\treturn false\r\n\treturn true\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isArrayOfHashes = (lItems) =>\r\n\t# --- undefined items are allowed\r\n\r\n\tif ! isArray(lItems)\r\n\t\treturn false\r\n\tfor item in lItems\r\n\t\tif defined(item) && ! isHash(item)\r\n\t\t\treturn false\r\n\treturn true\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport sortArrayOfHashes = (lHashes, key) =>\r\n\r\n\tassert isArrayOfHashes(lHashes), \"Not an array of hashes\"\r\n\r\n\t# --- NOTE: works whether values are strings or numbers\r\n\tcompareFunc = (a, b) =>\r\n\t\tif a[key] < b[key]\r\n\t\t\treturn -1\r\n\t\telse if a[key] > b[key]\r\n\t\t\treturn 1\r\n\t\telse\r\n\t\t\treturn 0\r\n\tlHashes.sort(compareFunc)\r\n\r\n\t# --- NOTE: array is sorted in place, but sometimes\r\n\t#           it's useful if we return a ref to it anyway\r\n\treturn lHashes\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport sortedArrayOfHashes = (lHashes, key) =>\r\n\r\n\tassert isArrayOfHashes(lHashes), \"Not an array of hashes\"\r\n\r\n\t# --- NOTE: works whether values are strings or numbers\r\n\tcompareFunc = (a, b) =>\r\n\t\tif a[key] < b[key]\r\n\t\t\treturn -1\r\n\t\telse if a[key] > b[key]\r\n\t\t\treturn 1\r\n\t\telse\r\n\t\t\treturn 0\r\n\treturn lHashes.toSorted(compareFunc)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isArrayOfStrings = (lItems) =>\r\n\t# --- undefined items are allowed\r\n\r\n\tif ! isArray(lItems)\r\n\t\treturn false\r\n\tfor item in lItems\r\n\t\tif defined(item) && ! isString(item)\r\n\t\t\treturn false\r\n\treturn true\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport words = (lStrings...) =>\r\n\r\n\tlWords = []\r\n\tfor str in lStrings\r\n\t\tstr = str.trim()\r\n\t\tif (str != '')\r\n\t\t\tfor word in str.split(/\\s+/)\r\n\t\t\t\tlWords.push word\r\n\treturn lWords\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isBoolean = (x) =>\r\n\r\n\treturn (jsType(x)[0] == 'boolean')\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isFunction = (x) =>\r\n\r\n\tmtype = jsType(x)[0]\r\n\treturn (mtype == 'function') || (mtype == 'class')\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isIterable = (obj) =>\r\n\r\n\tif (obj == undef) || (obj == null)\r\n\t\treturn false\r\n\treturn (typeof obj[Symbol.iterator] == 'function')\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isRegExp = (x) =>\r\n\r\n\treturn (jsType(x)[0] == 'regexp')\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isHash = (x, lKeys) =>\r\n\r\n\tif (jsType(x)[0] != 'hash')\r\n\t\treturn false\r\n\tif defined(lKeys)\r\n\t\tif isString(lKeys)\r\n\t\t\tlKeys = words(lKeys)\r\n\t\telse if ! isArray(lKeys)\r\n\t\t\tthrow new Error(\"lKeys not an array: #{OL(lKeys)}\")\r\n\t\tfor key in lKeys\r\n\t\t\tif ! x.hasOwnProperty(key)\r\n\t\t\t\treturn false\r\n\treturn true\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport removeKeys = (item, lKeys) =>\r\n\r\n\tassert isArray(lKeys), \"not an array\"\r\n\t[type, subtype] = jsType(item)\r\n\tswitch type\r\n\t\twhen 'array'\r\n\t\t\tfor subitem in item\r\n\t\t\t\tremoveKeys subitem, lKeys\r\n\t\twhen 'hash', 'object'\r\n\t\t\tfor key in lKeys\r\n\t\t\t\tif item.hasOwnProperty(key)\r\n\t\t\t\t\tdelete item[key]\r\n\t\t\tfor prop,value of item\r\n\t\t\t\tremoveKeys value, lKeys\r\n\treturn item\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isObject = (x, lReqKeys=undef) =>\r\n\r\n\tif (jsType(x)[0] != 'object')\r\n\t\treturn false\r\n\r\n\tif defined(lReqKeys)\r\n\t\tif isString(lReqKeys)\r\n\t\t\tlReqKeys = words(lReqKeys)\r\n\t\tassert isArray(lReqKeys), \"lReqKeys not an array: #{OL(lReqKeys)}\"\r\n\t\tfor key in lReqKeys\r\n\t\t\ttype = undef\r\n\t\t\tif lMatches = key.match(///^ (\\&) (.*) $///)\r\n\t\t\t\t[_, type, key] = lMatches\r\n\t\t\tif notdefined(x[key])\r\n\t\t\t\treturn false\r\n\t\t\tif (type == '&') && (typeof x[key] != 'function')\r\n\t\t\t\treturn false\r\n\treturn true\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isClass = (x) =>\r\n\r\n\treturn (jsType(x)[0] == 'class')\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport className = (item) =>\r\n\t# --- item can be a class or an object\r\n\r\n\tif isClass(item)\r\n\t\tif lMatches = item.toString().match(/class\\s+(\\w+)/)\r\n\t\t\treturn lMatches[1]\r\n\t\telse\r\n\t\t\tthrow new Error(\"className(): Bad input class\")\r\n\telse if isObject(item)\r\n\t\treturn item.constructor.name\r\n\telse\r\n\t\treturn undef\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport isScalar = (x) =>\r\n\r\n\treturn isNumber(x) || isString(x) || isBoolean(x)\r\n\r\n# ---------------------------------------------------------------------------\r\n#   blockToArray - split a block into lines\r\n\r\nexport blockToArray = (block) =>\r\n\r\n\tif (block == undef) || (block == '')\r\n\t\treturn []\r\n\telse\r\n\t\tassert isString(block), \"block is #{OL(block)}\"\r\n\t\tlLines = block.split(/\\r?\\n/)\r\n\t\treturn lLines\r\n\r\n# ---------------------------------------------------------------------------\r\n#   arrayToBlock - block and lines in block will have no trailing whitespace\r\n\r\nexport arrayToBlock = (lLines, hEsc=undef) =>\r\n\r\n\tif (lLines == undef)\r\n\t\treturn ''\r\n\tassert isArray(lLines), \"lLines is not an array\"\r\n\tlResult = []\r\n\tfor line in lLines\r\n\t\tif defined(line)\r\n\t\t\tlResult.push rtrim(line)\r\n\tif lResult.length == 0\r\n\t\treturn ''\r\n\telse\r\n\t\tresult = lResult.join(\"\\n\")\r\n\t\tif defined(hEsc)\r\n\t\t\tresult = escapeStr(result, hEsc)\r\n\t\treturn result\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport toBlock = (item) =>\r\n\r\n\tif isString(item)\r\n\t\treturn item\r\n\telse\r\n\t\treturn arrayToBlock(item)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport toArray = (item) =>\r\n\r\n\tif isArray(item)\r\n\t\t# --- We need to split any strings containing a \\n\r\n\t\tlLines = []\r\n\t\tfor line in item\r\n\t\t\tif hasChar(line, \"\\n\")\r\n\t\t\t\tfor str in line.split(/\\r?\\n/)\r\n\t\t\t\t\tlLines.push str\r\n\t\t\telse\r\n\t\t\t\tlLines.push line\r\n\t\treturn lLines\r\n\telse\r\n\t\treturn blockToArray(item)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport prefixBlock = (block, prefix) =>\r\n\r\n\tlLines = for line in toArray(block)\r\n\t\t\"#{prefix}#{line}\"\r\n\treturn toBlock(lLines)\r\n\r\n# ---------------------------------------------------------------------------\r\n#   rtrim - strip trailing whitespace\r\n\r\nexport rtrim = (line) =>\r\n\r\n\tassert isString(line), \"rtrim(): line is not a string\"\r\n\tlMatches = line.match(/\\s+$/)\r\n\tif defined(lMatches)\r\n\t\tn = lMatches[0].length   # num chars to remove\r\n\t\treturn line.substring(0, line.length - n)\r\n\telse\r\n\t\treturn line\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport hashFromString = (str) =>\r\n\r\n\tassert isString(str), \"not a string: #{OL(str)}\"\r\n\th = {}\r\n\tfor word in words(str)\r\n\t\tif lMatches = word.match(///^\r\n\t\t\t\t(\\!)?                    # negate value\r\n\t\t\t\t([A-Za-z][A-Za-z_0-9]*)  # identifier\r\n\t\t\t\t(?:\r\n\t\t\t\t\t(=)\r\n\t\t\t\t\t(.*)\r\n\t\t\t\t\t)?\r\n\t\t\t\t$///)\r\n\t\t\t[_, neg, ident, eq, str] = lMatches\r\n\t\t\tif nonEmpty(eq)\r\n\t\t\t\tassert isEmpty(neg), \"negation with string value\"\r\n\r\n\t\t\t\t# --- check if str is a valid number\r\n\t\t\t\tnum = parseFloat(str)\r\n\t\t\t\tif Number.isNaN(num)\r\n\t\t\t\t\t# --- TO DO: interpret backslash escapes\r\n\t\t\t\t\th[ident] = str\r\n\t\t\t\telse\r\n\t\t\t\t\th[ident] = num\r\n\t\t\telse if neg\r\n\t\t\t\th[ident] = false\r\n\t\t\telse\r\n\t\t\t\th[ident] = true\r\n\t\telse\r\n\t\t\tthrow new Error(\"Invalid word #{OL(word)}\")\r\n\treturn h\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport getOptions = (options=undef, hDefault={}) =>\r\n\r\n\t[type, subtype] = jsType(options)\r\n\tswitch type\r\n\t\twhen undef\r\n\t\t\thOptions = {}\r\n\t\twhen 'hash'\r\n\t\t\thOptions = options\r\n\t\twhen 'string'\r\n\t\t\thOptions = hashFromString(options)\r\n\t\telse\r\n\t\t\tthrow new Error(\"options not hash or string: #{OL(options)}\")\r\n\r\n\t# --- Fill in defaults for missing values\r\n\tfor own key,value of hDefault\r\n\t\tif ! hOptions.hasOwnProperty(key)\r\n\t\t\thOptions[key] = value\r\n\r\n\treturn hOptions\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport range = (n) =>\r\n\r\n\treturn [0..n-1]\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport rev_range = (n) =>\r\n\r\n\treturn [0..n-1].reverse()\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport warn = (msg) =>\r\n\r\n\tconsole.log \"WARNING: #{msg}\"\r\n\treturn\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport uniq = (lItems) =>\r\n\r\n\treturn [...new Set(lItems)]\r\n\r\n# ---------------------------------------------------------------------------\r\n#   say - print to the console (for now)\r\n#         later, on a web page, call alert(str)\r\n\r\nexport say = (x) =>\r\n\r\n\tif isHash(x)\r\n\t\tLOG JSON.stringify(x, Object.keys(h).sort(), 3)\r\n\telse\r\n\t\tLOG x\r\n\treturn\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport extractMatches = (line, regexp, convertFunc=undef) =>\r\n\r\n\tlStrings = [...line.matchAll(regexp)]\r\n\tlStrings = for str in lStrings\r\n\t\tstr[0]\r\n\tif defined(convertFunc)\r\n\t\tlConverted = for str in lStrings\r\n\t\t\tconvertFunc(str)\r\n\t\treturn lConverted\r\n\telse\r\n\t\treturn lStrings\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport getTimeStr = (date=undef) =>\r\n\r\n\tif date == undef\r\n\t\tdate = new Date()\r\n\treturn date.toLocaleTimeString('en-US')\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport getDateStr = (date=undef) =>\r\n\r\n\tif date == undef\r\n\t\tdate = new Date()\r\n\treturn date.toLocaleDateString('en-US')\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport timestamp = (dateStr=undef, locale='en-US') =>\r\n\r\n\tif defined(dateStr)\r\n\t\tdate = new Date(dateStr)\r\n\telse\r\n\t\tdate = new Date()\r\n\tstr1 = date.toLocaleDateString(locale)\r\n\tstr2 = date.toLocaleTimeString(locale)\r\n\treturn \"#{str1} #{str2}\"\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport msSinceEpoch = (dateStr=undef) =>\r\n\r\n\tif defined(dateStr)\r\n\t\tdate = new Date(dateStr)\r\n\telse\r\n\t\tdate = new Date()\r\n\treturn date.getTime()\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport formatDate = (dateStr=undef, dateStyle='medium', locale='en-US') =>\r\n\r\n\tif defined(dateStr)\r\n\t\tdate = new Date(dateStr)\r\n\telse\r\n\t\tdate = new Date()\r\n\treturn new Intl.DateTimeFormat(locale, {dateStyle}).format(date)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport getDumpStr = (label, str, hOptions={}) =>\r\n\t# --- Valid options:\r\n\t#        escape - escape space & TAB chars\r\n\t#        width\r\n\r\n\tlLines = []\r\n\t{escape, width} = getOptions(hOptions, {\r\n\t\tescape: false\r\n\t\twidth: 42\r\n\t\t})\r\n\r\n\tif isString(str)\r\n\t\tstringified = false\r\n\telse if defined(str)\r\n\t\tstr = JSON.stringify(str, undef, 3)\r\n\t\tstringified = true\r\n\telse\r\n\t\tstr = 'undef'\r\n\t\tstringified = true\r\n\r\n\tlLines.push '='.repeat(width)\r\n\tlLines.push centeredText(label, width)\r\n\r\n\tif stringified\r\n\t\tlLines.push '-'.repeat(width)\r\n\telse\r\n\t\tlLines.push '='.repeat(width)\r\n\r\n\tif escape\r\n\t\tlLines.push escapeStr(str, hEscNoNL)\r\n\telse\r\n\t\tlLines.push str.replace(/\\t/g, \"   \")\r\n\tlLines.push '='.repeat(width)\r\n\treturn lLines.join(\"\\n\")\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport eachCharInString = (str, func) =>\r\n\r\n\tfor ch in Array.from(str)\r\n\t\tif !func(ch)\r\n\t\t\treturn false\r\n\treturn true\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport DUMP = (label, obj, hOptions={}) =>\r\n\r\n\tassert isString(label), \"no label\"\r\n\tconsole.log getDumpStr(label, obj, hOptions)\r\n\treturn\r\n\r\n# ---------------------------------------------------------------------------\r\n# in callback set():\r\n#    - return undef to NOT set\r\n#    - return value (possibly changed) to set\r\n# in callback get():\r\n#    - return (possibly changed) value\r\n# ---------------------------------------------------------------------------\r\n\r\nexport getProxy = (obj, hCallbacks) =>\r\n\t# --- Keys in hFuncs can be: 'get','set'\r\n\r\n\thHandlers = {}\r\n\tif hCallbacks.hasOwnProperty('set')\r\n\t\thHandlers.set = (obj, prop, value) ->\r\n\t\t\tnewval = hCallbacks.set(obj, prop, value)\r\n\t\t\tif defined(newval)   # don't set if callback returns false\r\n\t\t\t\tReflect.set(obj, prop, newval)\r\n\t\t\treturn true\r\n\r\n\tif hCallbacks.hasOwnProperty('get')\r\n\t\thHandlers.get = (obj, prop) ->\r\n\t\t\tvalue = Reflect.get(obj, prop)\r\n\t\t\treturn hCallbacks.get(obj, prop, value)\r\n\r\n\tif isEmpty(hHandlers)\r\n\t\treturn obj\r\n\telse\r\n\t\treturn new Proxy(obj, hHandlers)\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport sleep = (secs) =>\r\n\r\n\treturn new Promise((r) => setTimeout(r, 1000 * secs))\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nhTimers = {}    # { <id> => <timer>, ... }\r\n\r\nexport schedule = (secs, keyVal, func, lArgs...) =>\r\n\r\n\tassert isFunction(func), \"not a function: #{OL(func)}\"\r\n\r\n\t# --- if there's currently a timer with the same keyVal, kill it\r\n\tif defined(timer = hTimers[keyVal])\r\n\t\tclearTimeout timer\r\n\thTimers[keyVal] = setTimeout(func, 1000 * secs, lArgs...)\r\n\treturn\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport hit = (pct) ->\r\n\r\n\treturn Math.random() * 100 < pct\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport choose = (lItems) ->\r\n\r\n\treturn lItems[Math.floor(Math.random()*lItems.length)]\r\n\r\n# ---------------------------------------------------------------------------\r\n# --- shuffle an array in place, return ref to shuffled array\r\n\r\nexport shuffle = (lItems) ->\r\n\r\n\ti = lItems.length\r\n\r\n\t# --- While there remain elements to shuffle.\r\n\twhile (i > 0)\r\n\r\n\t\t# --- Pick a remaining element.\r\n\t\ti2 = Math.floor(Math.random() * i)\r\n\t\ti -= 1\r\n\r\n\t\t# --- And swap it with the current element.\r\n\t\t[lItems[i], lItems[i2]] = [lItems[i2], lItems[i]];\r\n\r\n\treturn lItems\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport pad = (x, width, hOptions={}) =>\r\n\t# --- hOptions.justify can be 'left','center','right'\r\n\r\n\t{decPlaces, justify, truncate} = getOptions hOptions, {\r\n\t\tdecPlaces: undef\r\n\t\tjustify: undef\r\n\t\ttruncate: false\r\n\t\t}\r\n\t[type, subtype] = jsType(x)\r\n\tswitch type\r\n\t\twhen undef\r\n\t\t\tstr = 'undef'\r\n\t\t\tif notdefined(justify)\r\n\t\t\t\tjustify = 'left'\r\n\t\twhen 'string'\r\n\t\t\tstr = x\r\n\t\t\tif notdefined(justify)\r\n\t\t\t\tjustify = 'left'\r\n\t\twhen 'boolean'\r\n\t\t\tif x\r\n\t\t\t\tstr = 'true'\r\n\t\t\telse\r\n\t\t\t\tstr = 'false'\r\n\t\t\tif notdefined(justify)\r\n\t\t\t\tjustify = 'center'\r\n\t\twhen 'number'\r\n\t\t\tif defined(decPlaces)\r\n\t\t\t\tstr = x.toFixed(decPlaces)\r\n\t\t\telse if (subtype == 'integer')\r\n\t\t\t\tstr = x.toString()\r\n\t\t\telse\r\n\t\t\t\tstr = x.toFixed(2)\r\n\t\t\tif notdefined(justify)\r\n\t\t\t\tjustify = 'right'\r\n\t\twhen 'object'\r\n\t\t\tstr = '[Object]'\r\n\t\t\tif notdefined(justify)\r\n\t\t\t\tjustify = 'left'\r\n\t\telse\r\n\t\t\tcroak \"Invalid value: #{OL(x)}\"\r\n\r\n\ttoAdd = width - str.length\r\n\tif (toAdd == 0)\r\n\t\treturn str\r\n\telse if (toAdd < 0)\r\n\t\tif truncate\r\n\t\t\treturn str.substring(0, width)\r\n\t\telse\r\n\t\t\treturn str\r\n\r\n\tswitch justify\r\n\t\twhen 'left'\r\n\t\t\treturn str + ' '.repeat(toAdd)\r\n\t\twhen 'center'\r\n\t\t\tlPad = Math.floor(toAdd / 2)\r\n\t\t\trPad = toAdd - lPad\r\n\t\t\treturn \"#{' '.repeat(lPad)}#{str}#{' '.repeat(rPad)}\"\r\n\t\twhen 'right'\r\n\t\t\treturn ' '.repeat(toAdd) + str\r\n\t\telse\r\n\t\t\tcroak \"Invalid value for justify: #{justify}\"\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport forEachItem = (iter, func, hContext={}) =>\r\n\t# --- func() gets (item, hContext)\r\n\t#        hContext includes key _index\r\n\t#     return value from func() is added to\r\n\t#        returned array if defined\r\n\t#     if func() throws\r\n\t#        thrown strings are interpreted as\r\n\t#           \"stop\" - stop the iteration\r\n\t#           any other string - an error\r\n\t#           non-string - is rethrown\r\n\r\n\tassert isIterable(iter), \"not an iterable\"\r\n\tlItems = []\r\n\tindex = 0\r\n\tfor item from iter\r\n\t\thContext._index = index\r\n\t\tindex += 1\r\n\t\ttry\r\n\t\t\tresult = func(item, hContext)\r\n\t\t\tif defined(result)\r\n\t\t\t\tlItems.push result\r\n\t\tcatch err\r\n\t\t\tif isString(err)\r\n\t\t\t\tif (err == 'stop')\r\n\t\t\t\t\treturn lItems\r\n\t\t\t\telse\r\n\t\t\t\t\tthrow new Error(\"forEachItem: Bad throw '#{err}'\")\r\n\t\t\telse\r\n\t\t\t\tthrow err    # rethrow the error\r\n\treturn lItems\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport addToHash = (obj, lIndexes, value) =>\r\n\r\n\t# --- Allow passing a simple string or integer\r\n\tif isString(lIndexes) || isInteger(lIndexes)\r\n\t\tlIndexes = [lIndexes]\r\n\telse\r\n\t\tassert isArray(lIndexes), \"Bad indexes: #{OL(lIndexes)}\"\r\n\r\n\tassert nonEmpty(lIndexes), \"empty lIndexes\"\r\n\tkey = lIndexes.pop()\r\n\r\n\tsubobj = obj\r\n\tfor index in lIndexes\r\n\t\tif defined(obj[index])\r\n\t\t\tsubobj = subobj[index]\r\n\t\telse if isNumber(index) || isString(index)\r\n\t\t\tsubobj[index] = {}\r\n\t\t\tsubobj = subobj[index]\r\n\t\telse\r\n\t\t\tcroak \"Bad index: #{OL(index)}\"\r\n\tsubobj[key] = value\r\n\treturn obj\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport flattenToHash = (x) =>\r\n\r\n\tif isHash(x)\r\n\t\treturn x\r\n\telse if isArray(x)\r\n\t\thResult = {}\r\n\t\tfor item in x\r\n\t\t\tif isHash(item)\r\n\t\t\t\tfor own key,value of item\r\n\t\t\t\t\thResult[key] = value\r\n\t\t\telse if isArray(item)\r\n\t\t\t\tfor subitem in item\r\n\t\t\t\t\tfor own key,value of flattenToHash(subitem)\r\n\t\t\t\t\t\thResult[key] = value\r\n\t\t\telse\r\n\t\t\t\tcroak \"not a hash or array: #{OL(item)}\"\r\n\treturn hResult\r\n"
  ]
}