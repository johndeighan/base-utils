{
  "version": 3,
  "file": "exceptions.js",
  "sourceRoot": "..\\..\\",
  "sources": [
    "src\\lib\\exceptions.coffee"
  ],
  "names": [],
  "mappings": "AAAmB;AAAA,IAAA,KAAA,EAAA,aAAA,EAAA,KAAA,EAAA;;AAEnB,OAAA;EAAQ,UAAR;EAAoB,OAApB;CAAA,MAAA;;AACA,OAAA;EACC,KADD;EACQ,OADR;EACiB,UADjB;EAC6B,OAD7B;CAAA,MAAA;;AAIA,aAAA,GAAgB;;AAChB,KAAA,GAAQ,KARW;;;;AAanB,aAAA,GAAgB;;AAEhB,OAAA,IAAO,OAAA,GAAU,CAAA,CAAA,GAAA;EAChB,aAAA,GAAgB;AADA;;AAIjB,OAAA,IAAO,QAAA,GAAW,CAAA,CAAA,GAAA;AAClB,MAAA;EAAC,MAAA,GAAS,aAAa,CAAC,IAAd,CAAmB,IAAnB;EACT,aAAA,GAAgB;AAChB,SAAO;AAHU,EAnBC;;;AAyBnB;;AACA,OAAA,IAAO,wBAAA,GAA2B,CAAA,CAAA,GAAA;EAEjC,KAAA,GAAQ;EACR,OAAA,CAAA;AAHiC,EA1Bf;;;AAkCnB,OAAA,IAAO,WAAA,GAAc,CAAC,OAAK,IAAN,CAAA,GAAA;AACrB,MAAA,IAAA;;EAEC,IAAA,GAAO;EACP,aAAA,GAAgB;AAChB,SAAO;AALa,EAlCF;;;AA2CnB,KAAA,GAAQ,CAAC,GAAD,CAAA,GAAA;EAEP,IAAG,aAAH;WACC,aAAa,CAAC,IAAd,CAAmB,GAAnB,EADD;GAAA,MAEK,IAAG,KAAH;WACJ,OAAO,CAAC,GAAR,CAAY,GAAZ,EADI;;AAJE,EA3CW;;;;;AAsDnB,OAAA,IAAO,MAAA,GAAS,CAAC,IAAD,EAAO,GAAP,CAAA,GAAA;AAEhB,MAAA,CAAA,EAAA,OAAA,EAAA,GAAA,EAAA;EAAC,IAAG,CAAE,IAAL;IACC,OAAA,GAAU,UAAA,CAAA;IAEV,KAAA,CAAM,2BAAN;IACA,KAAA,CAAM,wBAAN;IACA,KAAA,yCAAA;;MACC,KAAA,CAAM,IAAA,CAAA,CAAM,OAAA,CAAQ,IAAR,CAAN,CAAA,CAAN;IADD;IAEA,KAAA,CAAM,2BAAN;IACA,KAAA,CAAM,CAAA,OAAA,CAAA,CAAU,GAAV,CAAA,CAAN;IACA,KAAA,CAAM,GAAN,EATD;;AAUA,SAAO;AAZQ,EAtDG;;;;;AAwEnB,OAAA,IAAO,KAAA,GAAQ,CAAC,MAAI,eAAL,EAAsB,QAAM,KAA5B,EAAmC,MAAI,KAAvC,CAAA,GAAA;AAEf,MAAA,MAAA,EAAA;EAAC,IAAG,CAAC,OAAO,GAAP,KAAc,QAAf,CAAA,IAA4B,CAAC,GAAA,YAAe,MAAhB,CAA/B;IACC,MAAA,GAAS,IADV;GAAA,MAAA;IAGC,MAAA,GAAS,GAAG,CAAC,OAAJ,IAAe,gBAHzB;;EAKA,IAAG,OAAA,CAAQ,KAAR,CAAH;IACC,MAAA,GAAS,CAAA,eAAA,CAAA,CAAkB,MAAlB,CAAA,EADV;GAAA,MAAA;IAGC,MAAA,GAAS,CAAA,eAAA,CAAA,CACS,MADT;AAAA,CAAA,CAEN,KAFM,CAAA;AAAA,CAAA,CAGN,IAAI,CAAC,SAAL,CAAe,GAAf,CAHM,CAAA,EAHV;;EASA,IAAG,aAAH;IACC,KAAA,CAAM,MAAN;WACA,OAAO,CAAC,IAAR,CAAA,EAFD;GAAA,MAAA;;IAKC,KAAA,GAAQ,KADV;IAEE,MAAM,IAAI,KAAJ,CAAU,MAAV,EANP;;AAhBc",
  "sourcesContent": [
    "# exceptions.coffee\r\n\r\nimport {getV8Stack, nodeStr} from '@jdeighan/base-utils/ll-v8-stack'\r\nimport {\r\n\tundef, defined, notdefined, isEmpty,\r\n\t} from '@jdeighan/base-utils/ll-utils'\r\n\r\ndoHaltOnError = false\r\ndoLog = true\r\n\r\n# ---------------------------------------------------------------------------\r\n# simple redirect to an array - useful in unit tests\r\n\r\nlExceptionLog = undef\r\n\r\nexport exReset = () =>\r\n\tlExceptionLog = []\r\n\treturn\r\n\r\nexport exGetLog = () =>\r\n\tresult = lExceptionLog.join(\"\\n\")\r\n\tlExceptionLog = undef\r\n\treturn result\r\n\r\n# ---------------------------------------------------------------------------\r\n`/** prevents logging of exceptions */`\r\nexport suppressExceptionLogging = () =>\r\n\r\n\tdoLog = false\r\n\texReset()\r\n\treturn\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport haltOnError = (flag=true) =>\r\n\t# --- return existing setting\r\n\r\n\tsave = doHaltOnError\r\n\tdoHaltOnError = flag\r\n\treturn save\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nEXLOG = (str) =>\r\n\r\n\tif lExceptionLog\r\n\t\tlExceptionLog.push str\r\n\telse if doLog\r\n\t\tconsole.log str\r\n\r\n# ---------------------------------------------------------------------------\r\n#   assert - mimic nodejs's assert\r\n#   return true so we can use it in boolean expressions\r\n\r\nexport assert = (cond, msg) =>\r\n\r\n\tif ! cond\r\n\t\tlFrames = getV8Stack()\r\n\r\n\t\tEXLOG '-------------------------'\r\n\t\tEXLOG 'JavaScript CALL STACK:'\r\n\t\tfor node in lFrames\r\n\t\t\tEXLOG \"   #{nodeStr(node)}\"\r\n\t\tEXLOG '-------------------------'\r\n\t\tEXLOG \"ERROR: #{msg}\"\r\n\t\tcroak msg\r\n\treturn true\r\n\r\n# ---------------------------------------------------------------------------\r\n#   croak - throws an error after possibly printing useful info\r\n#           err can be a string or an Error object\r\n\r\nexport croak = (err=\"unknown error\", label=undef, obj=undef) =>\r\n\r\n\tif (typeof err == 'string') || (err instanceof String)\r\n\t\tcurmsg = err\r\n\telse\r\n\t\tcurmsg = err.message || \"unknown error\"\r\n\r\n\tif isEmpty(label)\r\n\t\tnewmsg = \"ERROR (croak): #{curmsg}\"\r\n\telse\r\n\t\tnewmsg = \"\"\"\r\n\t\t\tERROR (croak): #{curmsg}\r\n\t\t\t#{label}:\r\n\t\t\t#{JSON.stringify(obj)}\r\n\t\t\t\"\"\"\r\n\r\n\tif doHaltOnError\r\n\t\tEXLOG newmsg\r\n\t\tprocess.exit()\r\n\telse\r\n\t\t# --- re-throw the error\r\n\t\tdoLog = true    # reset for next error\r\n\t\tthrow new Error(newmsg)\r\n"
  ]
}