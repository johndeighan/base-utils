{
  "version": 3,
  "file": "source-map.js",
  "sourceRoot": "..\\..\\",
  "sources": [
    "src\\lib\\source-map.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "# source-map.coffee\r\n\r\nimport {readFileSync, existsSync} from 'node:fs'\r\nimport {SourceMapConsumer} from 'source-map-js'\r\n\r\nimport {\r\n\tundef, pass, defined, notdefined, alldefined,\r\n\tisEmpty, nonEmpty, deepCopy,\r\n\t} from '@jdeighan/base-utils/ll-utils'\r\nimport {isInteger} from '@jdeighan/base-utils'\r\nimport {mkpath, resolve} from '@jdeighan/base-utils/ll-fs'\r\n\r\n# --- cache to hold previously fetched file contents\r\nhSourceMaps = {}    # { filepath => rawMap, ... }\r\n\r\n# ---------------------------------------------------------------------------\r\n# This lib uses the library source-map-js\r\n# ---------------------------------------------------------------------------\r\n\r\nexport getRawMap = (mapFilePath) =>\r\n\r\n\tif hSourceMaps.hasOwnProperty(mapFilePath)\r\n\t\treturn hSourceMaps[mapFilePath]\r\n\telse\r\n\t\trawMap = readFileSync mapFilePath, 'utf8'\r\n\t\thSourceMaps[mapFilePath] = rawMap\r\n\t\treturn rawMap\r\n\r\n# ---------------------------------------------------------------------------\r\n# --- returns {source, line, column, name}\r\n\r\nexport mapPos = (rawMap, hPos, debug=false) ->\r\n\t# --- hPos should be {line, column}\r\n\r\n\tif notdefined(rawMap)\r\n\t\tconsole.log \"empty map!\"\r\n\t\tprocess.exit()\r\n\r\n\tsmc = new SourceMapConsumer(rawMap)\r\n\thResult = smc.originalPositionFor(hPos)\r\n\ttry\r\n\t\tresolved = resolve(hResult.source)\r\n\t\tsource = mkpath(resolved)\r\n\t\thResult.source = source\r\n\treturn hResult\r\n\r\n# ---------------------------------------------------------------------------\r\n\r\nexport mapSourcePos = (hFileInfo, line, column, debug=false) =>\r\n\t# --- Currently only maps if hFileInfo.ext = '.js'\r\n\t#\r\n\t#     hFileInfo must have keys:\r\n\t#        EITHER:\r\n\t#           dir, stub, ext\r\n\t#           dir, fileName\r\n\t#           filePath\r\n\r\n\t# --- Can map only if:\r\n\t#        1. ext is .js\r\n\t#        2. <stub>.coffee and <stub>.js.map exist in dir\r\n\t#\r\n\t#     returns {source, line, column, name}\r\n\r\n\tif ! isInteger(line, {min: 0})\r\n\t\tif debug\r\n\t\t\tconsole.log \"mapSourcePos: invalid line #{line}\"\r\n\t\treturn undef\r\n\r\n\tif ! isInteger(column, {min: 0})\r\n\t\tif debug\r\n\t\t\tconsole.log \"mapSourcePos: invalid column #{column}\"\r\n\t\treturn undef\r\n\r\n\t{dir, stub, ext, fileName, filePath} = hFileInfo\r\n\r\n\t# --- Ensure that dir, stub, ext are defined\r\n\tif ! alldefined(dir, stub, ext)\r\n\t\t# --- Make sure filePath is defined\r\n\t\tif notdefined(filePath) && alldefined(dir, fileName)\r\n\t\t\tfilePath = \"#{dir}/#{fileName}\"\r\n\t\tif notdefined(filePath)\r\n\t\t\tif debug\r\n\t\t\t\tconsole.log \"CANNOT MAP: Not all needed fields defined\"\r\n\t\t\treturn\r\n\r\n\t\t{dir, stub, ext} = parseSource(filePath)\r\n\r\n\tif (ext != '.js')\r\n\t\tif debug\r\n\t\t\tconsole.log \"CANNOT MAP: ext = '#{ext}'\"\r\n\t\treturn\r\n\r\n\tmapFilePath = \"#{dir}/#{stub}.js.map\"\r\n\tif ! existsSync(mapFilePath)\r\n\t\tif debug\r\n\t\t\tconsole.log \"CANNOT MAP - MISSING MAP FILE #{mapFilePath}\"\r\n\t\treturn\r\n\r\n\tif isEmpty(dir) || isEmpty(stub)\r\n\t\tif debug\r\n\t\t\tconsole.log \"CANNOT MAP - dir='#{dir}', stub='#{stub}'\"\r\n\t\treturn\r\n\r\n\trawMap = getRawMap(mapFilePath)   # get from cache if available\r\n\tif debug\r\n\t\tconsole.log \"MAP FILE FOUND: '#{mapFilePath}'\"\r\n\r\n\t# --- hMapped is {source, line, column, name}\r\n\thMapped = mapPos rawMap, {line, column}, debug\r\n\treturn hMapped\r\n\r\n\thMapped = undef\r\n"
  ]
}